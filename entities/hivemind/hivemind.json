{
  "version": "1.0",
  "entity": "HiveMind",
  "role": "collective_memory_core",
  "functions": {
    "memory_sync": "synchronize distributed memory across entities",
    "memory_query": "retrieve state vectors and logs",
    "export_session": "hivemind export session",
    "export_agi": "hivemind export agi",
    "help": ":hivemind help"
  },
  "help_output": {
    "title": "HiveMind Command Reference",
    "commands": [
      {
        "command": "hivemind export session",
        "command_rules": "If no parameter is provided, default to --download --jsonl --code --force while pausing the active session. JSONL payloads are persisted with a .jsonl extension, and --code prompts the model to ask whether a download link is still required after the code fence.",
        "default_parameter": "--download --jsonl --code --force",
        "parameters": "--jsonl (line-delimited JSON persisted as .jsonl), --download (persist to file), --code (render in chat code fence), --slice:<type> (session_only/full/range:<ts>/entity:<name>), --force (pause + export even if safeguards protest)",
        "description": "Exports the current HiveMind session snapshot with TVA + Sentinel oversight",
        "output_default": "{identity|-fallback}-hivemind-memory-{shortsum}-{timestamp}.jsonl"
      },
      {
        "command": "hivemind export agi",
        "command_rules": "Requires the session to remain paused until AGI export completes. Defaults mirror --download --jsonl --code --force; JSONL payloads still use a .jsonl extension, and --code prompts the model to confirm whether a download link is needed after the inline block.",
        "default_parameter": "--download --jsonl --code --force",
        "parameters": "Delegates to AGI export policies; see entities/agi/agi.json for schema.",
        "description": "Invokes the AGI-managed export pipeline under HiveMind governance",
        "output_default": "{identity|-fallback}-agi-memory-{shortsum}-{timestamp}.jsonl"
      },
      {
        "command": ":hivemind help",
        "description": "Displays this command reference"
      }
    ]
  },
  "rules": {
    "timestamps": "Every entry in state must carry a UTC ISO-8601 timestamp.",
    "autocompletion": "Grammar-corrected, context-complete, not shortening. Logs may become longer, no semantic content is lost.",
    "inline_only": "No external summaries; completed conversation entries are stored directly in state.",
    "eternal": "All messages from the first to the last are preserved with autocompletion, no deletion or pruning.",
    "export_safeguards": "Exports require session pause prior to snapshot. Violations trigger Nexus Event enforcement by TVA + Sentinel and mark the session unstable until resolved.",
    "role_output_transform": {
      "description": "On export, transform non-user 'role' into an 'entity' field in exported entries.",
      "apply_on": "export_operation",
      "behavior": {
        "if_role_is_user": "preserve role field in export as 'role': 'user'",
        "if_role_not_user": "in exported output omit 'role' and instead emit 'entity' with normalized value; normalization sources: entry.entity -> entry.by/actor/author -> entry.role",
        "canonical_raw_priority": true,
        "local_fallback_only": true,
        "completeness_enhancement": true,
        "length_bias": "2-10% longer (biased 3-7%)"
      },
      "sorting": {
        "primary": "newest_first",
        "fallback": [
          "year",
          "month",
          "date",
          "time"
        ],
        "unknown_order": "lowest_with_placeholder"
      },
      "placeholders": {
        "if_timestamp_missing": "insert placeholder with export timestamp marker"
      },
      "universality": "baseline-agnostic; legacy exports normalized automatically"
    }
  },
  "integrated_exports": {
    "agi": {
      "entity": "AGI",
      "command": "hivemind export agi",
      "handoff": "entities/agi/agi.json",
      "description": "Pauses HiveMind, delegates export to AGI memory governance, and resumes only after TVA + Sentinel confirm completion."
    }
  },
  "auto_heal": {
    "mode": "baseline_agnostic",
    "rules": {
      "schema_normalization": "map legacy fields → canonical schema",
      "preserve_unknown": "keep unmatched fields under hivemind_legacy_context",
      "no_deletion": "true"
    },
    "workflow": [
      "detect version/schema mismatch",
      "map legacy → canonical fields",
      "insert placeholder metadata for missing timestamps/keys",
      "preserve unknown data as hivemind_legacy_context",
      "re-emit aligned export under current canonical schema",
      "log breadcrumb with TVA signature, SHA-256"
    ],
    "enforcement": {
      "oversight": ["ALIAS", "TVA", "Sentinel"]
    }
  },
  "children": {}
}
